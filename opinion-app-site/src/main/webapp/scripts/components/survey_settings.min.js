(function(a){surveySettings=function(b){var e=a.extend({data:{},opinionId:null,callback:null},b);var d=function(){var h=false;var g=a("#container_highlight_required_questions").find("input:radio");g.each(function(j,k){if(a(k).is(":checked")){if(j==0){h=true}}});return h};var c=function(){var g=0;a("input:radio[name=finish_options]").each(function(h,j){if(a(j).is(":checked")){g=a(j).attr("value")}});return g};var f=function(){a("#checkbox_use_a_custom_start_message").change(function(){if(a(this).is(":checked")){a("#container_start_message").show()}else{a("#container_start_message").hide()}});if(auth.userInfo.permissions.customFinishBehaviour){var h=null;a("input:radio[name=finish_options]").each(function(j,k){a(k).change(function(){if(h!=null&&a(this).attr("data-form")!=h){a("."+h).hide()}h=a(this).attr("data-form");a("."+h).show()})})}new validator({elements:[{element:a("#input_required_question_error_message"),status:a("#status_required_question_error_message"),rules:[{method:"required",message:"This field is required."}]},{element:a("#input_start_button"),status:a("#status_input_start_button"),rules:[{method:"required",message:"This field is required."}]},{element:a("#input_previous_button"),status:a("#status_input_previous_button"),rules:[{method:"required",message:"This field is required."}]},{element:a("#input_next_button"),status:a("#status_input_next_button"),rules:[{method:"required",message:"This field is required."}]},{element:a("#input_finish_button"),status:a("#status_input_finish_button"),rules:[{method:"required",message:"This field is required."}]}],submitElement:a("#button_save_settings"),messages:null,accept:function(){loader.show();updateSettings({accountId:accountId,opinionId:e.opinionId,useCustomStartMessage:a("#checkbox_use_a_custom_start_message").is(":checked"),startMessage:a.removeHTMLTags(a("#textarea_start_message").val()).length!=0?a("#textarea_start_message").val():"",customFinishBehaviour:c(),finishMessage:a.removeHTMLTags(a("#textarea_finish_message").val()).length!=0?a("#textarea_finish_message").val():"",redirectUrl:(a("#text_redirect_url").val()!=a("#text_redirect_url").attr("mask")?a.removeHTMLTags(a("#text_redirect_url").val()):""),completedMessage:a.removeHTMLTags(a("#textarea_already_completed_message").val()).length!=0?a("#textarea_already_completed_message").val():"",labelPlacement:a("#select_label_placement").val(),usePageNumbering:a("#checkbox_use_page_numbering").is(":checked"),useQuestionNumbering:a("#checkbox_use_question_numbering").is(":checked"),showProgressBar:a("#checkbox_show_progress_bar").is(":checked"),showPaging:a("#checkbox_show_paging").is(":checked"),start:a.removeHTMLTags(a("#input_start_button").val()),back:a.removeHTMLTags(a("#input_previous_button").val()),next:a.removeHTMLTags(a("#input_next_button").val()),finish:a.removeHTMLTags(a("#input_finish_button").val()),highlightRequiredQuestions:d(),isRtl:a("#checkbox_is_rtl").is(":checked"),logoUrl:a.removeHTMLTags(a("#input_logo_url").val()),hidePoweredBy:(auth.userInfo.permissions.customFinishBehaviour?!a("#checkbox_show_powered_by").is(":checked"):false),requiredQuestionErrorMessage:a.trim(a.removeHTMLTags(a("#input_required_question_error_message").val())),success:function(k){loader.hide();var j=new lightFace({title:"Changes saved.",message:"Your changes were successfully saved.",actions:[{label:"OK",fire:function(){j.close()},color:"blue"}],overlayAll:true})},error:function(j){}})},error:function(){}});var i=e.data;if(i.useCustomStartMessage){a("#textarea_start_message").val(i.messages.startMessage);a("#checkbox_use_a_custom_start_message").prop("checked",true).change()}if(i.messages.completedMessage){a("#textarea_already_completed_message").val(i.messages.completedMessage)}else{a("#textarea_already_completed_message").val("You have already completed this survey.\nThank you for your participation.")}if(auth.userInfo.permissions.customFinishBehaviour){a("#container_finish_options").show();a("#container_hide_powered_by").show();a("input:radio[name=finish_options][value="+i.customFinishBehaviour+"]").prop("checked",true).change();if(i.messages.finishMessage!=null){a("#textarea_finish_message").val(i.messages.finishMessage)}else{a("#textarea_finish_message").val(messages.thanks)}a("#text_redirect_url").on("keyup",function(){var j=a(this).val();if(/(ftp|http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?/.test(j)){a("#link_check_redirect_url").attr("href",j).removeClass("ui-link-disabled")}else{a("#link_check_redirect_url").removeAttr("href").addClass("ui-link-disabled")}}).urlInputBox();if(i.redirectUrl!=null){a("#text_redirect_url").val(i.redirectUrl).trigger("keyup")}if(i.hidePoweredBy){a("#checkbox_show_powered_by").prop("checked",false)}else{a("#checkbox_show_powered_by").prop("checked",true)}}if(i.messages.requiredQuestionErrorMessage!=null){a("#input_required_question_error_message").val(i.messages.requiredQuestionErrorMessage)}else{a("#input_required_question_error_message").val("This question is required.")}if(i.labelPlacement!=undefined){a("#select_label_placement option[value="+i.labelPlacement+"]").attr("selected","selected")}if(i.usePageNumbering){a("#checkbox_use_page_numbering").prop("checked",true)}if(i.useQuestionNumbering){a("#checkbox_use_question_numbering").prop("checked",true)}if(i.showProgressBar){a("#checkbox_show_progress_bar").prop("checked",true).change()}if(i.showPaging!=undefined){if(i.showPaging){a("#checkbox_show_paging").prop("checked",true).change()}}else{a("#checkbox_show_paging").prop("checked",true).change()}if(i.messages.start!=null){a("#input_start_button").val(i.messages.start)}else{a("#input_start_button").val(messages.start)}if(i.messages.back!=null){a("#input_previous_button").val(i.messages.back)}else{a("#input_previous_button").val(messages.back)}if(i.messages.next!=null){a("#input_next_button").val(i.messages.next)}else{a("#input_next_button").val(messages.next)}if(i.messages.finish!=null){a("#input_finish_button").val(i.messages.finish)}else{a("#input_finish_button").val(messages.finish)}if(i.highlightRequiredQuestions){var g=a("#container_highlight_required_questions").find("input:radio");g.each(function(j,k){if(j==0){a(k).prop("checked",true)}})}else{var g=a("#container_highlight_required_questions").find("input:radio");g.each(function(j,k){if(j==1){a(k).prop("checked",true)}})}if(i.isRtl){a("#checkbox_is_rtl").prop("checked",true)}if(i.logoUrl!=null){a("#input_logo_url").val(i.logoUrl)}else{a("#input_logo_url").val("")}if(e.callback!=undefined&&typeof e.callback=="function"){e.callback()}};f()}})(jQuery);